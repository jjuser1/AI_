YOLOv8 모델을 사용하여 톨게이트 무인화 시스템에서 비용 책정 시스템을 만들었습니다.

전기전자심화설계 및
소프트웨어 실습
<텀프로젝트>



담당교수 : 조용범 교수님
조       : 목요일 7조
이름     : 201910858 백승우
		  201910815 김정원
		  201910459 남경탁

사용한 Hw:  nvidia jetson orin nx


1. 주제
CCTV영상 기반 차선 및 차량 구분을 통한 톨게이트 비용 청구 시스템

2. 주제 선정 이유
하이패스는 유료화 도로에서 널리 사용되는 전자 요금 징수 시스템이며, 이를 통해 운전자들은 톨게이트를 통과할 때 차량을 정지시지 않아도 자동으로 통행료를 결제할 수 있다. 하이패스의 도입으로 톨게이트에서의 교통 체증이 많이 해소되었지만, 아직도 하이패스를 사용하지 않는 운전자들을 위한 유인 수납 차선이 존재한다.
이런 유인 수납 차선에서 근무하는 근무자들은 종일 좁은 부스에서 근무를 하며, 화장실 등 개인의 시간을 보장받기 어려운 경우가 많다. 이는 매우 힘든 업무 조건이며, 교통공사에서도 이런 직원들에게 지불해야 하는 인건비가 부담이 된다.
하지만, 모든 톨게이트를 하이패스 전용으로 변경하는 것은 많은 시간과 비용이 소모되고, 아직 하이패스를 설치하지 않는 차량들을 고려해야 하는 문제가 있다. 따라서 더 효율적이고 실용적인 해결책을 생각해 보았다.
이를 해결하기 위해 CCTV영상을 활용하여 차량을 구분하고 톨게이트 비용을 자동으로 청구하는 시스템을 제안했다.
이 시스템은 전 차선에서 차량 구분을 진행하고, 각 차종에 맞는 요금을 청구하며, 유인 수납 차선에서 근무하는 직원들의 업무 부담을 줄이고 교통공사의 인건비 또한 절감할 수 있다.
추가적으로, 이 시스템에서 번호판 인식을 위한 OCR기능을 추가하면 하이패스를 설치하지 않아도 번호판 영상인식을 통해 하이패스와 같이 요금 후불고지가 가능해진다. 또한, 양방향 과속단속 또는 버스 전용 차로 위반 단속 등의 다양한 교통 법규 위반을 단속하는 데도 활용될 수 있다. 이를 통해 교통 법규 준수를 더욱 강화하고, 안전한 도로 문화를 조성하는 데에도 기여할 수 있을 것으로 생각된다


  ![image](https://github.com/jjuser1/AI_/assets/145631638/91ab65f4-67e2-478b-8fe7-55901a941c33)

  ![image](https://github.com/jjuser1/AI_/assets/145631638/38b55959-a222-4c2a-a7c7-bf16ae3bbfd0)
  ![image](https://github.com/jjuser1/AI_/assets/145631638/3c64ff42-ea19-4e79-8d40-ce50dfacfa88)

프로젝트에서 사용한 모델은 직접 훈련하였습니다.
훈련결과
![image](https://github.com/jjuser1/AI_/assets/145631638/f538b34c-67b1-495d-a982-eb18b555086b)
![image](https://github.com/jjuser1/AI_/assets/145631638/41114ea7-757c-4f8e-b145-48ad188dc2c4)

3. main.py의 실행
사진추출 파트
   ![image](https://github.com/jjuser1/AI_/assets/145631638/9c1f9371-12d8-4c27-a9a1-6336a5767981)
   ![image](https://github.com/jjuser1/AI_/assets/145631638/9faae457-52d0-4555-a6c9-fe6ef5bd04ec)
사진에서 영역 설정
![image](https://github.com/jjuser1/AI_/assets/145631638/7e466701-8891-4262-aa33-aa30472820fa)
![image](https://github.com/jjuser1/AI_/assets/145631638/beb51977-842c-4967-ad9c-59a6a3360554)

추론 및 비쵸, 요금 책정

![image](https://github.com/jjuser1/AI_/assets/145631638/d6d10655-349d-4b04-9b3b-31b75e048896)
바운딩 박스에서 빨간 색 좌표가 영역에 들어가면 가격 스택에 한개씩 쌓이게 되고 UI에서 확인 가능하다.

엔터키를 사용하여 요금을 뺄 수 있다.(요금을 무인 시스템으로 청구하는 시스템은 개발하지 않았으며, 요금을 쌓아 놓기만 한다.)

4. AI 최적화
   .pt 모델을 .engine으로 배포하여 최적화 하였습니다.
   ![image](https://github.com/jjuser1/AI_/assets/145631638/7725854b-e833-45f8-a5cb-d8f6cc5fada5)
.pt 는 한 프레임당 동작하는 속도가 최소 63ms 최대 105ms로 모델이 추적하는데 시간이 많이 소요되었다.

![image](https://github.com/jjuser1/AI_/assets/145631638/bc656014-c1f3-4db5-a581-fe3e3878e66a)
.engine (TensorRT) 결과는 위의 사진과 같다. 한 프레임마다 소요된 시간은 평균적으로 40ms로 모두 50ms를 초과하지 않는다. 이 는 사용자가 detecting된 화면을 봤을 때 더 매끄럽게 영상이 흘러가는 것처럼 느껴진다.








